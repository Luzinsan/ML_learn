
![[MaskRCNN.png]]
- является расширением архитектуры [[Faster R-CNN]]
- Помимо класса и ограничивающей рамки рисует маску объекта
- Является современной технологией сегментации изображений
- Работает со скоростью 5 кадров в секунду


Принцип: такой же, как у Faster R-CNN, но есть отличия
1. Используется архитектура [[ResNet 101]] для извлечения карты признаков из изображения
2. [[Region Proposal Network (RPN)]] получает карты признаков и возвращает рамки-кандидаты
3. [[Region of interest (ROI)]] для преобразования в единую форму
4. Регионы проходят через полносвязанную сеть для прогнозирования метки класса, ограничивающей рамки и маски сегментации
5. Вычисление маски:
	1. Для всех регионов вычисляется [[Intersection over Union (IoU)]]. 
	2. Если $IoU>=0.5$ - это ROI (область интереса), иначе он отбрасывается.
	3. Рассматривая каждую ROI, вычисляется маска сегментации 28x28, которая затем масштабируется для вывода

# Использование
- Клонируем репозиторий mask rcnn
`git clone https://github.com/matterport/Mask_RCNN.git`
- Dependencies:
	- _numpy 
	- _scipy
	- _Pillow
	- _cython
	- _matplotlib_
	- _scikit-image_
	- _tensorflow>=1.3.0_
	- _keras>=2.0.8 
	- _opencv-python_
	- _h5py_
	- _imgaug 
	- _IPython_
- Загрузка весов Mask R-CNN, обученного на MS COCO: `https://github.com/matterport/Mask_RCNN/releases`
- 